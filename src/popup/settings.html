<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shkolo Tweaks</title>
    <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" rel="stylesheet">
    <link rel="stylesheet" href="popup.css">
    <style>
        .container {
            width: 50%;
        }
    </style>
</head>

<body>
    <div class="background"></div>
    <div class="bg_overlay"></div>
    <div id="box_popup_overlay" style="display: none;"></div>
    <div class="container" style="height: 100%;">
        <div class="logo has-text-centered mb-5">
            <img src="../assets/LogoBanner.png" style="width: 200px; margin-bottom: -25px; margin-top: -16px;"
                alt="Shkolo Tweaks Logo" id="logo">
        </div>
        <div class="box-wrapper" style="width: 100%;">
            <!-- Search for settings -->
            <div class="settings-search">
                <div class="search-input-wrapper" role="search" aria-label="Search settings">
                    <span class="search-icon" aria-hidden="true">üîç</span>
                    <input id="settings_search" type="text" placeholder="Search settings..." autocomplete="off" />
                    <button id="settings_search_clear" class="clear-btn" aria-label="Clear search"
                        title="Clear">‚úï</button>
                    <div id="settings_search_count" class="search-count empty" aria-live="polite"></div>
                </div>
            </div>
            <div class="box">
                <h1 id="shkolo_settings"></h1>
                <div class="options no-toggle">
                    <input id="theme_dummy" type="checkbox" style="display:none">
                    <label for="theme_dummy" class="switch" style="display:none;"></label>
                    <label id="theme_label" style="width: fit-content; margin-right: 0;"></label>
                    <button id="open_custom_css" class="custom-css-btn" title="Custom CSS"
                        aria-label="Open Custom CSS editor" style="margin-left:8px; vertical-align:middle;">
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                            <path
                                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z" />
                        </svg>
                        <span class="label" style="text-wrap: nowrap;">Custom CSS</span>
                    </button>
                    <p class="description" style="width: 100%;"></p>
                    <div>
                        <div class="theme-toggle-wrapper" style="display:flex; align-items:center; gap:8px;">
                            <div class="custom-themes-inline"
                                style="display:flex; gap:8px; flex-wrap:nowrap; align-items:center; text-wrap: nowrap;">
                            </div>
                            <button id="custom_themes_more_btn" class="custom-theme-more-btn"
                                style="display:none; margin-left:6px;">More</button>
                            <div class="theme-toggle" aria-label="Theme toggle" role="tablist">
                                <button id="lightTheme" class="active" role="tab" aria-pressed="true"
                                    title="Light theme"></button>
                                <button id="darkTheme" role="tab" aria-pressed="false" title="Dark theme"></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="horizontal-options">
                    <div class="options">
                        <input id="rounded" type="checkbox">
                        <label for="rounded" class="switch"></label>
                        <label for="rounded" id="roundedLabel"></label>
                        <p class="description" id="rounded_description"></p>
                    </div>
                    <div class="options">
                        <input id="blur_data" type="checkbox">
                        <label for="blur_data" class="switch"></label>
                        <label for="blur_data" id="blurLabel"></label>
                        <p class="description" id="blur_data_description"></p>
                    </div>
                    <div class="options">
                        <input id="schedule" type="checkbox">
                        <label for="schedule" class="switch"></label>
                        <label for="schedule" id="schedule_widget"></label>
                        <p class="description" id="schedule_widget_description"></p>
                    </div>
                    <div class="options">
                        <input id="control_tests" type="checkbox">
                        <label for="control_tests" class="switch"></label>
                        <label for="control_tests" id="control_tests_widget"></label>
                        <p class="description" id="control_tests_widget_description"></p>
                    </div>
                    <div class="options">
                        <input id="reorder_sidebar" type="checkbox">
                        <label for="reorder_sidebar" class="switch"></label>
                        <label for="reorder_sidebar" id="reorderSidebar"></label>
                        <p class="description" id="reorderSidebar_description"></p>
                    </div>
                    <div class="options">
                        <input id="colored_icons" type="checkbox">
                        <label for="colored_icons" class="switch"></label>
                        <label for="colored_icons" id="coloredIcons"></label>
                        <p class="description" id="coloredIcons_description"></p>
                    </div>
                    <div class="options">
                        <input id="no_avatars" type="checkbox">
                        <label for="no_avatars" class="switch"></label>
                        <label for="no_avatars" id="noAvatars"></label>
                        <p class="description" id="noAvatars_description"></p>
                    </div>
                    <div class="options">
                        <input id="autoRefresh" type="checkbox">
                        <label for="autoRefresh" class="switch"></label>
                        <label for="autoRefresh" id="auto_refresh"></label>
                        <p class="description" id="auto_refresh_description"></p>
                    </div>
                    <div class="options">
                        <input id="disable_theme_sync" type="checkbox">
                        <label for="disable_theme_sync" class="switch"></label>
                        <label for="disable_theme_sync" id="disableThemeSync_label">Disable theme sync</label>
                        <p class="description" id="disableThemeSync_description">Do not sync the active theme or custom
                            themes to Chrome sync.</p>
                        <p style="font-weight: 500;">Note: This setting is stored locally.</p>
                    </div>
                </div>
            </div>

            <!-- QoL Settings -->
            <div class="box">
                <h1 id="qol_settings_title">QoL Settings</h1>
                <div class="horizontal-options" style="margin-top: .5rem;">
                    <div class="options">
                        <input id="remove_ads" type="checkbox">
                        <label for="remove_ads" class="switch"></label>
                        <label for="remove_ads" id="removeAds"></label>
                        <p class="description" id="removeAds_description"></p>
                    </div>
                    <div class="options">
                        <input id="load_qol_css" type="checkbox">
                        <label for="load_qol_css" class="switch"></label>
                        <label for="load_qol_css" id="loadQoLCss"></label>
                        <p class="description" id="loadQoLCss_description"></p>
                    </div>
                    <div class="options">
                        <input id="email_and_tel" type="checkbox">
                        <label for="email_and_tel" class="switch"></label>
                        <label for="email_and_tel" id="emailAndTel"></label>
                        <p class="description" id="emailAndTel_description"></p>
                    </div>
                    <div class="options">
                        <input id="messages_background_fix" type="checkbox">
                        <label for="messages_background_fix" class="switch"></label>
                        <label for="messages_background_fix" id="messagesBackgroundFix"></label>
                        <p class="description" id="messagesBackgroundFix_description"></p>
                    </div>
                    <div class="options">
                        <input id="details_date" type="checkbox">
                        <label for="details_date" class="switch"></label>
                        <label for="details_date" id="detailsDate"></label>
                        <p class="description" id="detailsDate_description"></p>
                    </div>
                    <div class="options">
                        <input id="inapp_ext_settings" type="checkbox">
                        <label for="inapp_ext_settings" class="switch"></label>
                        <label for="inapp_ext_settings" id="inAppExtSettings"></label>
                        <p class="description" id="inAppExtSettings_description"></p>
                    </div>
                    <div class="options">
                        <input id="move_logout_button" type="checkbox">
                        <label for="move_logout_button" class="switch"></label>
                        <label for="move_logout_button" id="moveLogOutButton"></label>
                        <p class="description" id="moveLogOutButton_description"></p>
                    </div>
                </div>
            </div>

            <!-- Beta Features -->
            <div class="box">
                <h1 id="beta_features_title">Experimental Features</h1>
                <div class="horizontal-options" style="margin-top: .5rem;">
                    <div class="options">
                        <input id="year_countdown" type="checkbox">
                        <label for="year_countdown" class="switch"></label>
                        <label for="year_countdown" id="yearCountdown"></label>
                        <p class="description" id="yearCountdown_description"></p>
                    </div>
                    <div class="options">
                        <input id="stats_panel" type="checkbox">
                        <label for="stats_panel" class="switch"></label>
                        <label for="stats_panel" id="statsPanel"></label>
                        <p class="description" id="statsPanel_description"></p>
                    </div>
                    <div class="options">
                        <input id="trusted_devices_logins" type="checkbox">
                        <label for="trusted_devices_logins" class="switch"></label>
                        <label for="trusted_devices_logins" id="trustedDevicesLogins"></label>
                        <p class="description" id="trustedDevicesLogins_description"></p>
                    </div>
                </div>
            </div>

            <div class="box">
                <h1 id="developer_settings"></h1>
                <div class="options">
                    <input id="dev_tools" type="checkbox">
                    <label for="dev_tools" class="switch"></label>
                    <label for="dev_tools" id="devTools"></label>
                    <p class="description" id="devTools_description"></p>
                </div>
                <div style="display: flex; margin-top: 16px;">
                    <p class="settings-button" id="chrome_storage" style="width: 100%; text-align: center;">Chrome
                        Storage Editor</p>
                </div>
            </div>
        </div>

        <!-- Chrome Storage Editor -->
        <div class="box popup" id="chrome_storage_popup" style="display: none; max-width: 45%;">
            <div class="popup-header">
                <h1 class="popup-title">Chrome Storage Editor</h1>
            </div>
            <div class="popup-content" id="chrome_storage_content">
                <div class="popup-inputs" style="display: flex; flex-direction: column; gap: 8px;">
                    <input type="text" id="chrome_storage_key" placeholder="Key" class="input">
                </div>
                <div class="popup-buttons" style="margin-top: 8px; margin-bottom: 4px;">
                    <button id="chrome_storage_update_button" class="button is-info">Refresh Table</button>
                    <button id="chrome_storage_set_button" class="button is-primary">Create</button>
                    <button id="chrome_storage_remove_button" class="button is-danger">Remove</button>
                    <button id="chrome_storage_clear_button" class="button is-danger is-pulled-right">Delete All Data</button>
                </div>
                <div id="chrome_storage_result"></div>
            </div>
        </div>

        <!-- Storage Edit Popup -->
        <div class="box popup" id="chrome_storage_edit_popup" style="display:none; max-width:720px;">
            <div class="popup-header">
                <h1 class="popup-title">Edit Storage Value</h1>
            </div>
            <div class="popup-content">
                <div style="display:flex; flex-direction:column; gap:8px;">
                    <div>
                        <label style="font-weight:600; display:block; margin-bottom:4px;">Key</label>
                        <input id="edit_key" class="input" readonly />
                    </div>
                    <div>
                        <label style="font-weight:600; display:block; margin-bottom:4px;">Storage</label>
                        <select id="edit_store" class="input">
                            <option value="sync">sync</option>
                            <option value="local">local</option>
                            <option value="managed">managed</option>
                            <option value="session">session</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight:600; display:block; margin-bottom:4px;">Value</label>
                        <textarea id="edit_value"
                            style="width:100%; height:180px; font-family:monospace; font-size:13px; padding:8px; box-sizing:border-box;"></textarea>
                    </div>
                    <div style="display:flex; align-items:center; gap:12px;">
                        <label style="cursor:pointer;"><input type="checkbox" id="edit_parse_json"
                                style="margin-right:6px;">Treat as JSON (parse on save)</label>
                        <span style="color:#666; font-size:12px;">When checked, input is JSON-parsed before
                            saving.</span>
                    </div>
                    <div style="display:flex; gap:8px; margin-top:8px;">
                        <button id="chrome_storage_edit_save" class="button is-primary">Save</button>
                        <button id="chrome_storage_edit_cancel" class="button">Cancel</button>
                        <button id="chrome_storage_edit_remove" class="button is-danger is-pulled-right">Remove</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Custom CSS Editor -->
        <div class="box popup" id="custom_css_popup" style="display: none; max-width: 600px;">
            <div class="popup-header">
                <h1 class="popup-title">Custom Styles (CSS)</h1>
            </div>
            <p style="margin-bottom:8px;">Add custom CSS for the extension. Save to persist; Apply to preview in this
                popup.</p>
            <div class="popup-content" id="custom_css_content">
                <textarea id="custom_css_textarea" placeholder="/* your css here */"
                    style="width:100%; height:250px; font-family: monospace; font-size:13px; padding:8px; box-sizing:border-box;"></textarea>
                <div style="display:flex; gap:8px; margin-top:8px;">
                    <button id="custom_css_apply" class="button is-info">Apply</button>
                    <button id="custom_css_save" class="button is-primary">Save</button>
                    <button id="custom_css_reset" class="button is-warning">Reset</button>
                    <button id="custom_css_export" class="button">Export</button>
                    <button id="custom_css_close" class="button">Close</button>
                </div>
                <!-- Import file input (hidden) -->
                <input id="custom_css_import_file" type="file" accept=".css,text/css" style="display:none" />
                <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
                    <button id="custom_css_import_btn" class="button is-light">WIP: Import .css</button>
                    <span style="color:#666; font-size:12px;">You can import a .css file into the editor</span>
                </div>
                <!-- Export panel (hidden by default) -->
                <div id="custom_css_export_panel"
                    style="display:none; margin-top:10px; border-top:1px dashed #ddd; padding-top:10px;">
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;">
                        <div style="font-weight:600;">Export custom theme</div>
                    </div>
                    <div style="display:flex; gap:8px;">
                        <button id="custom_css_export_add" class="button is-primary">Add as custom theme</button>
                        <button id="custom_css_export_file" class="button is-link">Download .css</button>
                        <button id="custom_css_export_cancel" class="button">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- All Custom Themes Popup -->
        <div class="box popup" id="custom_themes_popup" style="display: none; max-width: 600px;">
            <div class="popup-header">
                <h1 class="popup-title">Custom Themes</h1>
                <button id="custom_themes_popup_close" class="button is-light">Close</button>
            </div>
            <div class="popup-content" id="custom_themes_list_popup"
                style="display:flex; flex-wrap:wrap; gap:8px; padding-top:8px;">
                <!-- Filled dynamically -->
            </div>
        </div>
    </div>

    <script src="../lib/jquery.min.js"></script>
    <script src="../utils.js"></script>
    <script src="../js/init.js"></script>
    <script src="i18n.js"></script>
    <script src="settings.js"></script>
</body>

</html>